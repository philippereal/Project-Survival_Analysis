---
title: "Rapport - Valeurs Extrême"
btitle: ""
author: "Philippe Real"
date: '`r format(Sys.time(), " %d %B, %Y")`'
abstract: "This is my abstract."
keywords: "R"
output:
  html_document:
    df_print: paged
    toc: yes
  word_document:
    toc: yes
  pdf_document:
    toc: yes
    toc_depth: 3
    fig_caption: yes
    keep_tex: yes
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r eval=FALSE, include=FALSE}
install.packages("evd")
install.packages("evir")
install.packages("ismev")
install.packages("fExtremes")
install.packages("extRemes")
```

```{r,echo=FALSE, message=FALSE, warning=FALSE, r,echo=FALSE}
rm(list=ls())

library(evd)
library(evir)
library(ismev)
library(fExtremes)
library(extRemes)
```


# Partie I - Comparaison des approches GEV et GPD sur les données *Marseille* 

On s'intéresse dans cette première partie, à la pluviométrie dans la vile de Marseille sur la période allant de 1864 à 1991.

Cette étude est réalisée à patir des données d'accumulations pluviométriques quotidiennes de $10^{−1}$ mm dans la vile de Marseille
pendant 127 ans d'observations (1864–1991). La première date est le 1er août 1864. Tous les 29 février ont été supprimés.
Pour cet ensemble de données, on va utiliser les deux approches (GEV et GPD) et les comparer.

## Lecture des données - description statistique

```{r echo=FALSE}
pluies = read.table("marseille.txt")[,1]
pluies.ts = ts(pluies,start=c(1864,213),frequency=365) # 213: 1 aout 1864
plot(pluies.ts,main="Pluies maximales journalieres Marseille")
matPluies = matrix(pluies,365,127) # decoupage en annees aout-juillet
maxPluies = apply(matPluies,2,max,na.rm = TRUE)
vecAn = 1864:1990
```

### Choix du niveau des blocs (GEV) et du seuillage (GPD)

* Ajustement GEV sur les max annuels

```{r echo=FALSE}
n <- length(pluies); PluieMat <- matrix(pluies[1:(n-n%%365)],nrow=365)
PluieMatrix <- apply(PluieMat,2,max)
fgev.pluie <- fgev(PluieMatrix)
fgev.pluie
```

#### Choix du seuil pour l'approche GPD

* function findthresh of the package evir (p38 cours III)

```{r echo=FALSE}
findthresh(pluies,c(1,10,100))
```

```{r echo=FALSE}
seuil<-findThreshold(as.timeSeries(pluies), n = c(10, 50, 100))
seuil
```

```{r echo=FALSE}
plot(pluies.ts,main="Pluies maximales journalieres Marseille")
abline(h=seuil[1],col="red")
abline(h=seuil[2],col="red",lty=2)
abline(h=seuil[3],col="red",lty=3)
legend('top',c("seuil à 10","seuil à 50","seuil à 100"),col="red",lty=c(1,2,3),lwd = rep(2,2))

```

* A partir des graphes tcplot: partie constante du graphe.
```{r echo=FALSE, message=FALSE, warning=FALSE}
tcplot(pluies.ts, tlim=c(10,1500))
```
seuil à 600?

cf p57 cours GPD
```{r echo=FALSE, fig.height=6, fig.width=10}
threshrange.plot(pluies, r = c(20, 1800), nint=10)
```

### Estimation des paramètre par MLE et PWM.

#### Approche GEV

```{r echo=FALSE, message=FALSE, warning=FALSE}
FitMle=fevd(pluies,type="GEV",method="MLE",time.units="days")#,time.units="day")
gev<-FitMle
ci.gev<-ci(FitMle,type="parameter")

gev.scale<- gev$results[1]$par[1]
gev.shape<- gev$results[1]$par[2]

FitGumb=fevd(pluies,type="Gumbel",method="MLE",time.units="days")#,time.units="day")
gumb<-FitGumb
ci.gumb<-ci(FitGumb,type="parameter")

FitMMT=fevd(pluies,threshold=seuil,type="GP",method="Lmoments",time.units="days")
gev.mmt<-FitMMT
ci.gev.mmt<-ci(FitMMT,type="parameter")

```

Méthode          |        scale               |            shape           |
---------------- | -------------------------- | -------------------------- |
GEV - MLE GV     | `r gev$results[1]$par[1]`  | `r mle$results[1]$par[2]`  |
GEV - MLE Gumbel | `r gumb$results[1]$par[1]` | `r gumb$results[1]$par[2]` |
GEV - Momments   | `r gev.mmt$results[1]`     | `r gev.mmt$results[2]`     |

* Approximations des paramètres $scale$ et $shape$ et Intervalles de confiance

```{r echo=FALSE}
ci.gev
ci.gumb
ci.gev.mmt
```

* Graphiques

```{r echo=FALSE, fig.height=8, fig.width=15}
plot(FitMle)
```

```{r echo=FALSE, fig.height=8, fig.width=12}
plot(FitGumb)
```

```{r echo=FALSE, fig.height=8, fig.width=12}
plot(FitMMT)
```

#### Approche GPD

* Estimation des paramètres par maximum de vraissamblance dans l'approche GPD (p47 cours GPD)

On utilise la fonction R fved avec 2 la méthode MLE et des moments

```{r echo=FALSE}
FitMle=fevd(pluies,type="GEV",method="MLE",time.units="days")#,time.units="day")
mle<-FitMle
ci.mle<-ci(FitMle,type="parameter")

seuil<-600

FitthreshMle=fevd(pluies,threshold=seuil,type="GP",method="MLE",time.units="days")#,time.units="day")
mle<-FitthreshMle
ci.mle<-ci(FitthreshMle,type="parameter")

FitthreshMleExp=fevd(pluies,threshold=seuil,type="Exponential",method="MLE",time.units="days")
exp<-FitthreshMleExp
ci.exp<-ci(FitthreshMleExp,type="parameter")

FitthreshMleMMT=fevd(pluies,threshold=seuil,type="GP",method="Lmoments",time.units="days")
mmt<-FitthreshMleMMT
ci.mmt<-ci(FitthreshMleMMT,type="parameter")

mle.scale<- mle$results[1]$par[1]
mle.shape<- mle$results[1]$par[2]

exp.scale<- exp$results[1]$par[1]
exp.shape<- exp$results[1]$par[2]

mmt.scale<- mmt$results[1]
mmt.shape<- mmt$results[2]
```


Méthode          |        scale              |            shape          |
---------------- | ------------------------- | ------------------------- |
GPD - MLE GV     | `r mle$results[1]$par[1]` | `r mle$results[1]$par[2]` |
GPD - MLE Exp    | `r exp$results[1]$par[1]` | `r exp$results[1]$par[2]` |
GPD - Momment GV | `r mmt$results[1]`        | `r mmt$results[2]`        |


* Approximations des paramètres $scale$ et $shape$ et Intervalles de confiance

```{r echo=FALSE}
ci.mle
ci.exp
ci.mmt
```

* Graphiques

```{r echo=FALSE, fig.height=8, fig.width=15}
plot(FitthreshMle)
```

```{r echo=FALSE, fig.height=8, fig.width=12}
plot(FitthreshMleExp)
```

```{r echo=FALSE, fig.height=8, fig.width=12}
plot(FitthreshMleMMT)
```

* Gumbel

```{r echo=FALSE}
FitMleGumbel=fevd(pluies,type="Gumbel",method="MLE")
gumb<-FitMleGumbel
ci.gumb <-  ci(FitMleGumbel,type="parameter")
```

```{r echo=FALSE, fig.height=7, fig.width=15}
plot(FitMleGumbel)
```

```{r echo=FALSE}
ci.gumb
```

```{r echo=FALSE}
qevd(1/100,loc = 109.93256, scale = 42.93768, type ="Gumbel", lower.tail = FALSE)
qevd(1-1/100,loc = 109.93256, scale = 42.93768, type ="Gumbel", lower.tail = TRUE)
summary(pluies)
```


#### Même chose avec fpot 

```{r echo=FALSE}
fitpot.pluies <- fpot(pluies,threshold=600)
fitpot.pluies
```


```{r echo=FALSE}
profile.pluies <- profile(fitpot.pluies,which="shape")
plot(profile.pluies)
```


```{r echo=FALSE}
par(mfrow=c(2,2))
plot(fitpot.pluies)

```

```{r echo=FALSE}

```


### Domaine d'attraction

```{r echo=FALSE}

```


```{r echo=FALSE}

```

### Niveau de retour et interprétation

* MEV

```{r echo=FALSE}

```


* GPD 

```{r echo=FALSE}

```

### Estimation du niveau de retour correspondant à une période 100 ans et 1000 ans

* MEV

```{r echo=FALSE}
ci.gev.100 <- ci(FitMle,type="return.level",return.period = 100)
ci.gmb.100 <- ci(FitGumb,type="return.level",return.period = 100)
ci.mmt.100 <- ci(FitMMT,type="return.level",return.period = 100)
ci.gev.1000 <- ci(FitMle,type="return.level",return.period = 1000)
ci.gmb.1000 <- ci(FitGumb,type="return.level",return.period = 1000)
ci.mmt.1000 <- ci(FitMMT,type="return.level",return.period = 1000)
```

Méthode         |  100-year return  |  IC 95% borne Inf  | IC 95% borne Sup   |
--------------- | ----------------- | ------------------ | ------------------ |
MLE GV          | `r ci.gev.100[2]` | `r ci.gev.100[1]`  | `r ci.gev.100[3]`  |
MLE Gumbel      | `r ci.gmb.100[2]` | `r ci.gmb.100[1]`  | `r ci.gmb.100[3]`  |
Momment GV      | `r ci.mmt.100[2]` | `r ci.mmt.100[1]`  | `r ci.mmt.100[3]`  |


Méthode         |  1000-year return |  IC 95% borne Inf  | IC 95% borne Sup   |
--------------- | ----------------- | ------------------ | ------------------ |
MLE GV          | `r ci.gev.1000[2]`| `r ci.gev.1000[1]` | `r ci.gev.1000[3]` |
MLE Gumbel      | `r ci.exp.1000[2]`| `r ci.exp.1000[1]` | `r ci.exp.1000[3]` |
Momment GV      | `r ci.mmt.1000[2]`| `r ci.mmt.1000[1]` | `r ci.mmt.1000[3]` |


```{r echo=FALSE}
ret.gev<- return.level(FitthreshMle, return.period = c(2, 20, 100,1000))
ret.gmb<- return.level(FitthreshMleExp, return.period = c(2, 20, 100,1000))
ret.mmt<- return.level(FitthreshMleMMT, return.period = c(2, 20, 100,1000))
```

Méthode         |  2-year level  |  20-year level | 100-year level | 1000-year level|
--------------- | -------------- | -------------- | -------------- | -------------- |
MLE GV          | `r ret.gev[1]` | `r ret.gev[2]` | `r ret.gev[3]` | `r ret.gev[4]` |
MLE Exponentiel | `r ret.gmb[1]` | `r ret.gmb[2]` | `r ret.gmb[3]` | `r ret.gmb[4]` |
Momment GV      | `r ret.mmt[1]` | `r ret.mmt[3]` | `r ret.mmt[3]` | `r ret.mmt[4]` |


* GPD 

```{r echo=FALSE}
ci.mle.100 <- ci(FitthreshMle,type="return.level",return.period = 100)
ci.exp.100 <- ci(FitthreshMleExp,type="return.level",return.period = 100)
ci.mmt.100 <- ci(FitthreshMleMMT,type="return.level",return.period = 100)
ci.mle.1000 <- ci(FitthreshMle,type="return.level",return.period = 1000)
ci.exp.1000 <- ci(FitthreshMleExp,type="return.level",return.period = 1000)
ci.mmt.1000 <- ci(FitthreshMleMMT,type="return.level",return.period = 1000)

```

Méthode         |  100-year return  |  IC 95% borne Inf  | IC 95% borne Sup   |
--------------- | ----------------- | ------------------ | ------------------ |
MLE GV          | `r ci.mle.100[2]` | `r ci.mle.100[1]`  | `r ci.mle.100[3]`  |
MLE Exponentiel | `r ci.exp.100[2]` | `r ci.exp.100[1]`  | `r ci.exp.100[3]`  |
Momment GV      | `r ci.mmt.100[2]` | `r ci.mmt.100[1]`  | `r ci.mmt.100[3]`  |


Méthode         |  1000-year return |  IC 95% borne Inf  | IC 95% borne Sup   |
--------------- | ----------------- | ------------------ | ------------------ |
MLE GV          | `r ci.mle.1000[2]`| `r ci.mle.1000[1]` | `r ci.mle.1000[3]` |
MLE Exponentiel | `r ci.exp.1000[2]`| `r ci.exp.1000[1]` | `r ci.exp.1000[3]` |
Momment GV      | `r ci.mmt.1000[2]`| `r ci.mmt.1000[1]` | `r ci.mmt.1000[3]` |



```{r echo=FALSE}
ret.mle<- return.level(FitthreshMle, return.period = c(2, 20, 100,1000))
ret.exp<- return.level(FitthreshMleExp, return.period = c(2, 20, 100,1000))
ret.mmt<- return.level(FitthreshMleMMT, return.period = c(2, 20, 100,1000))
```

Méthode         |  2-year level  |  20-year level | 100-year level | 1000-year level|
--------------- | -------------- | -------------- | -------------- | -------------- |
MLE GV          | `r ret.mle[1]` | `r ret.mle[2]` | `r ret.mle[3]` | `r ret.mle[4]` |
MLE Exponentiel | `r ret.exp[1]` | `r ret.exp[2]` | `r ret.exp[3]` | `r ret.exp[4]` |
Momment GV      | `r ret.mmt[1]` | `r ret.mmt[3]` | `r ret.mmt[3]` | `r ret.mmt[4]` |



```{r echo=FALSE}

```

```{r echo=FALSE}


```


```{r echo=FALSE}

```

```{r echo=FALSE}

```

## Conclusion - Comaparaison GPD et GEV


# Partie II - Approche GEV - Données *portpirie*

## Lecture des données - description statistique

```{r echo=FALSE}
data.portpirie<-portpirie
summary(data.portpirie)
```


```{r echo=FALSE}
portpirie.ts = ts(data.portpirie,start=c(1923) , end=(1987),frequency=1) #
plot(portpirie.ts,main="Sea level in portpirie - Australia",ylab="sea level (m)")
#matPluies = matrix(pluies,365,127) # decoupage en annees aout-juillet
#maxPluies = apply(matPluies,2,max,na.rm = TRUE)
#vecAn = 1864:1990
#plot(portpirie,main="Sea level in portpirie - Australia")
plot(portpirie,main="Sea level in portpirie - Australia",ylab="sea level (m)")

```


```{r echo=FALSE}

```


```{r echo=FALSE}

```


## Choix des blocs

```{r echo=FALSE}

```


```{r echo=FALSE}

```

## Estimation des paramètre par MLE et PWM.


```{r echo=FALSE, message=FALSE, warning=FALSE}
FitMle=fevd(portpirie,type="GEV",method="MLE",time.units="days")#,time.units="day")
gev<-FitMle
ci.gev<-ci(FitMle,type="parameter")

gev.scale<- gev$results[1]$par[1]
gev.shape<- gev$results[1]$par[2]

FitGumb=fevd(portpirie,type="Gumbel",method="MLE",time.units="days")#,time.units="day")
gumb<-FitGumb
ci.gumb<-ci(FitGumb,type="parameter")

#FitMMT=fevd(portpirie,type="GP",method="Lmoments",time.units="days")
#gev.mmt<-FitMMT
#ci.gev.mmt<-ci(FitMMT,type="parameter")

#GEV - Momments   | `r gev.mmt$results[1]`     | `r gev.mmt$results[2]`     |
```

Méthode          |        scale               |            shape           |
---------------- | -------------------------- | -------------------------- |
GEV - MLE GV     | `r gev$results[1]$par[1]`  | `r mle$results[1]$par[2]`  |
GEV - MLE Gumbel | `r gumb$results[1]$par[1]` | `r gumb$results[1]$par[2]` |


* Approximations des paramètres $scale$ et $shape$ et Intervalles de confiance

```{r echo=FALSE}
ci.gev
ci.gumb
ci.gev.mmt
```

* Graphiques

```{r echo=FALSE, fig.height=7, fig.width=15}
plot(FitMle)
```

```{r echo=FALSE, fig.height=8, fig.width=15}
plot(FitGumb)
```

* Estimation des paramètres avec *fgev*
```{r echo=FALSE}
library(evd)
fgev.portpirie <- fgev(portpirie)
fgev.portpirie
```

Le plot ne fonctionne pas?
```{r echo=FALSE}
#plot(fgev.portpirie)
```

* Quantiles extrêmes
```{r include=FALSE}
port.qfit=fgev(portpirie,prob=0.01)
port.qdev_prof=profile(port.qfit,which="quantile")
port.qPCI=plot(port.qdev_prof,main="Profile deviance of Quantile 0.01")
```

```{r echo=FALSE}
port.qfit=fgev(portpirie,prob=0.001)
port.qdev_prof=profile(port.qfit,which="quantile")
port.qPCI=plot(port.qdev_prof,main="Profile deviance of Quantile 0.001")
```

## Domaine d'attraction



```{r echo=FALSE}
```

## Niveau de retour et interprétation

```{r echo=FALSE}
```


```{r echo=FALSE}

```

## Estimation du niveau de retour correspondant à une période 100 ans et 1000 ans


```{r echo=FALSE}
ci.gev.100 <- ci(FitMle,type="return.level",return.period = 100)
ci.gmb.100 <- ci(FitGumb,type="return.level",return.period = 100)
#ci.mmt.100 <- ci(FitMMT,type="return.level",return.period = 100)
ci.gev.1000 <- ci(FitMle,type="return.level",return.period = 1000)
ci.gmb.1000 <- ci(FitGumb,type="return.level",return.period = 1000)
#ci.mmt.1000 <- ci(FitMMT,type="return.level",return.period = 1000)

#Momment GV      | `r ci.mmt.100[2]` | `r ci.mmt.100[1]`  | `r ci.mmt.100[3]`  |
#Momment GV      | `r ci.mmt.1000[2]`| `r ci.mmt.1000[1]` | `r ci.mmt.1000[3]` |
```

Méthode         |  100-year return  |  IC 95% borne Inf  | IC 95% borne Sup   |
--------------- | ----------------- | ------------------ | ------------------ |
MLE GV          | `r ci.gev.100[2]` | `r ci.gev.100[1]`  | `r ci.gev.100[3]`  |
MLE Gumbel      | `r ci.gmb.100[2]` | `r ci.gmb.100[1]`  | `r ci.gmb.100[3]`  |



Méthode         |  1000-year return |  IC 95% borne Inf  | IC 95% borne Sup   |
--------------- | ----------------- | ------------------ | ------------------ |
MLE GV          | `r ci.gev.1000[2]`| `r ci.gev.1000[1]` | `r ci.gev.1000[3]` |
MLE Gumbel      | `r ci.exp.1000[2]`| `r ci.exp.1000[1]` | `r ci.exp.1000[3]` |



```{r echo=FALSE}
ret.gev<- return.level(FitthreshMle, return.period = c(2, 20, 100,1000))
ret.gmb<- return.level(FitthreshMleExp, return.period = c(2, 20, 100,1000))
#ret.mmt<- return.level(FitthreshMleMMT, return.period = c(2, 20, 100,1000))
```

Méthode         |  2-year level  |  20-year level | 100-year level | 1000-year level|
--------------- | -------------- | -------------- | -------------- | -------------- |
MLE GV          | `r ret.gev[1]` | `r ret.gev[2]` | `r ret.gev[3]` | `r ret.gev[4]` |
MLE Gumbel      | `r ret.gmb[1]` | `r ret.gmb[2]` | `r ret.gmb[3]` | `r ret.gmb[4]` |


```{r echo=FALSE}

```

## Conclusion


# Partie III  - Approche GPD - Données *temps100m*

## Lecture des données - description statistique

```{r echo=FALSE, message=FALSE, warning=FALSE}
#require(stats)
temps100m = read.csv("./temps100m.csv",col.names = T)
time=temps100m[,1]
vtime<-as.vector(t(time))
class(vtime)
Time=sort(vtime,decreasing=TRUE) # pour ordonner les données.
plot(Time, ylab="Temps (secondes)", main="Records au 100M",type="l")
# As a last step all smoothed times are converted into speeds.
# Higher speeds correspond to "better" times.

TimeNeg<--Time
```

```{r echo=FALSE}

```


```{r echo=FALSE}

```

## Choix du niveau de seuillage

* function findthresh of the package evir (p38 cours III)

```{r echo=FALSE}
findthresh(TimeNeg,c(1,10,100))
```

```{r echo=FALSE}
seuil<-findThreshold(as.timeSeries(TimeNeg), n = c(10, 50, 100))
seuil
```

```{r echo=FALSE}
plot(TimeNeg,main="Temps au 100m")
abline(h=seuil[1],col="red")
abline(h=seuil[2],col="red",lty=2)
abline(h=seuil[3],col="red",lty=3)
legend('top',c("seuil à 10","seuil à 50","seuil à 100"),col="red",lty=c(1,2,3),lwd = rep(2,2))

```

* A partir des graphes tcplot: partie constante du graphe.

```{r echo=FALSE, fig.height=6, fig.width=10, message=FALSE, warning=FALSE}
threshrange.plot(TimeNeg)
```

On ontient un seuil paproximatif de -9.92

```{r echo=FALSE}

```


## Estimation des paramètre par MLE et PWM.

On utilise la fonction R fved avec 2 la méthode MLE et des moments

```{r echo=FALSE}
seuil<--9.92

FitthreshMle=fevd(TimeNeg,threshold=seuil,type="GP",method="MLE",time.units="days")#,time.units="day")
mle<-FitthreshMle
ci.mle<-ci(FitthreshMle,type="parameter")

FitthreshMleExp=fevd(TimeNeg,threshold=seuil,type="Exponential",method="MLE",time.units="days")
exp<-FitthreshMleExp
ci.exp<-ci(FitthreshMleExp,type="parameter")

FitthreshMleMMT=fevd(TimeNeg,threshold=seuil,type="GP",method="Lmoments",time.units="days")
mmt<-FitthreshMleMMT
ci.mmt<-ci(FitthreshMleMMT,type="parameter")



```

Méthode         |        scale              |            shape          |
--------------- | ------------------------- | ------------------------- |
MLE GV          | `r mle$results[1]$par[1]` | `r mle$results[1]$par[2]` |
MLE Exponentiel | `r exp$results[1]$par[1]` | `r exp$results[1]$par[2]` |
Momment GV      | `r mmt$results[1]`        | `r mmt$results[2]`        |


* Approximations des paramètres $scale$ et $shape$ et Intervalles de confiance

```{r echo=FALSE}
ci.mle
ci.exp
ci.mmt
```

* Graphiques

```{r echo=FALSE, fig.height=8, fig.width=15}
plot(FitthreshMle)
```

```{r echo=FALSE, fig.height=8, fig.width=12}
plot(FitthreshMleExp)
```

```{r echo=FALSE, fig.height=8, fig.width=12}
plot(FitthreshMleMMT)
```

* Gumbel

```{r echo=FALSE}
FitMleGumbel=fevd(TimeNeg,type="Gumbel",method="MLE")
gumb<-FitMleGumbel
ci.gumb <-  ci(FitMleGumbel,type="parameter")
```

```{r echo=FALSE}
plot(FitMleGumbel)
```

```{r echo=FALSE}
ci(FitMleGumbel,type="parameter")
```

## Domaine d'attraction

```{r echo=FALSE}

```


```{r echo=FALSE}

```

## Niveau de retour et interprétation

```{r echo=FALSE}

```


```{r echo=FALSE}

```

## Estimation du niveau de retour correspondant à une période 100 ans et 1000 ans


```{r echo=FALSE}
ci.mle.100 <- ci(FitthreshMle,type="return.level",return.period = 100)
ci.exp.100 <- ci(FitthreshMleExp,type="return.level",return.period = 100)
ci.mmt.100 <- ci(FitthreshMleMMT,type="return.level",return.period = 100)
ci.mle.1000 <- ci(FitthreshMle,type="return.level",return.period = 1000)
ci.exp.1000 <- ci(FitthreshMleExp,type="return.level",return.period = 1000)
ci.mmt.1000 <- ci(FitthreshMleMMT,type="return.level",return.period = 1000)

```

Méthode         |  100-year return  |  IC 95% borne Inf  | IC 95% borne Sup   |
--------------- | ----------------- | ------------------ | ------------------ |
MLE GV          | `r ci.mle.100[2]` | `r ci.mle.100[1]`  | `r ci.mle.100[3]`  |
MLE Exponentiel | `r ci.exp.100[2]` | `r ci.exp.100[1]`  | `r ci.exp.100[3]`  |
Momment GV      | `r ci.mmt.100[2]` | `r ci.mmt.100[1]`  | `r ci.mmt.100[3]`  |


Méthode         |  1000-year return |  IC 95% borne Inf  | IC 95% borne Sup   |
--------------- | ----------------- | ------------------ | ------------------ |
MLE GV          | `r ci.mle.1000[2]`| `r ci.mle.1000[1]` | `r ci.mle.1000[3]` |
MLE Exponentiel | `r ci.exp.1000[2]`| `r ci.exp.1000[1]` | `r ci.exp.1000[3]` |
Momment GV      | `r ci.mmt.1000[2]`| `r ci.mmt.1000[1]` | `r ci.mmt.1000[3]` |



```{r echo=FALSE}
ret.mle<- return.level(FitthreshMle, return.period = c(2, 20, 100,1000))
ret.exp<- return.level(FitthreshMleExp, return.period = c(2, 20, 100,1000))
ret.mmt<- return.level(FitthreshMleMMT, return.period = c(2, 20, 100,1000))
```

Méthode         |  2-year level  |  20-year level | 100-year level | 1000-year level|
--------------- | -------------- | -------------- | -------------- | -------------- |
MLE GV          | `r ret.mmt[1]` | `r ret.mmt[2]` | `r ret.mmt[3]` | `r ret.mmt[4]` |
MLE Exponentiel | `r ret.exp[1]` | `r ret.exp[2]` | `r ret.exp[3]` | `r ret.exp[4]` |
Momment GV      | `r ret.mmt[1]` | `r ret.mmt[3]` | `r ret.mmt[3]` | `r ret.mmt[4]` |



```{r echo=FALSE}

```


```{r echo=FALSE}

```


## Conclusion








